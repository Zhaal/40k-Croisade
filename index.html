<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Crusade Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="container">
        <header>
            <h1>Nexus Crusade Tracker</h1>
            <div class="campaign-controls">
                <button id="export-btn">Exporter la Campagne (JSON)</button>
                <button id="import-btn">Importer la Campagne (JSON)</button>
                <input type="file" id="import-file" accept=".json" style="display: none;">
            </div>
            <p class="storage-warning">
               ⚠️ **Attention :** Toutes les données sont sauvegardées localement dans votre navigateur.
                Utilisez l'export pour créer des sauvegardes !
            </p>
            <div class="management-controls">
                <button id="reset-campaign-btn" class="btn-danger">Explosion du Warp (Réinitialiser)</button>
                <button id="campaign-info-btn" class="btn-secondary">Informations de la campagne</button>
            </div>
        </header>

        <main id="player-list-view">
            <h2>Joueurs de la Campagne</h2>
            <div id="player-list">
                </div>
            <button id="add-player-btn" class="btn-primary">Ajouter un Joueur</button>
        </main>

        <section id="player-detail-view" class="hidden">
            <div class="roster-header">
                <h3>Crusade Force Roster</h3>
                <span>
                    <button id="back-to-system-btn" class="hidden" style="margin-right: 10px;">&larr; Retour au système</button>
                    <button id="back-to-list-btn">&larr; Retour à la liste</button>
                </span>
            </div>
            <div class="player-info-grid">
                <div class="info-box"><strong>Joueur:</strong> <span id="player-name-display"></span></div>
                <div class="info-box"><strong>Faction:</strong> <span id="player-faction-display"></span></div>
                <div class="info-box"><strong>Faction de Croisade:</strong> <input type="text" id="crusade-faction" placeholder="Ex: Imperium"></div>
                <div class="info-box">
                    <strong>Points de Réquisition:</strong>
                    <span id="pr-points" class="stat-value"></span> RP
                    <button class="tally-btn" data-action="decrease-rp">-</button>
                    <button class="tally-btn" data-action="increase-rp">+</button>
                </div>
                <div id="biomass-box" class="info-box hidden">
                    <strong>Points de Biomasse:</strong>
                    <span id="biomass-points" class="stat-value"></span>
                    <button class="tally-btn" data-action="decrease-biomass">-</button>
                    <button class="tally-btn" data-action="increase-biomass">+</button>
                </div>
                
                <div class="info-box">
                    <strong>Éclats de Sombreroche:</strong>
                    <span id="sombreroche-points" class="stat-value"></span>
                    <button class="tally-btn" data-action="decrease-sombreroche">-</button>
                    <button class="tally-btn" data-action="increase-sombreroche">+</button>
                </div>
                <div class="info-box">
                    <strong>Limite de Ravitaillement:</strong>
                    <div style="display: flex; align-items: center; gap: 8px; margin-top: 4px;">
                        <input type="number" id="supply-limit" min="0" style="width: 80px; display: inline-block;">
                        <span>PL</span>
                        <button id="increase-supply-limit-btn" class="tally-btn" title="Augmenter la limite de 200 PL pour 1 RP" style="margin-left: auto;">+200</button>
                    </div>
                </div>
                <div class="info-box">
                    <strong>Coût Optimisations:</strong>
                    <input type="number" id="upgrade-supply-cost" min="0"> PL
                </div>
                <div class="info-box">
                    <strong>Ravitaillement Utilisé:</strong> <span id="supply-used" class="stat-value readonly"></span> PL
                    <br>
                    <small>Restant: <span id="supply-remaining" style="color: white; font-weight: bold;"></span> PL</small>
                </div>
                <div class="info-box">
                    <strong>Décompte de Batailles:</strong> <span id="battle-tally" class="stat-value">0</span>
                    (V:<span id="wins">0</span> / D:<span id="losses">0</span>)
                    <div class="battle-tally-controls">
                        <button class="tally-btn" data-action="increase-win">+V</button>
                        <button class="tally-btn" data-action="decrease-win" title="Corriger Victoire">-V</button>
                        <button class="tally-btn" data-action="increase-loss">+D</button>
                        <button class="tally-btn" data-action="decrease-loss" title="Corriger Défaite">-D</button>
                    </div>
                </div>
            </div>

            <div id="sororitas-sainthood-box" class="hidden">
                <hr>
                <h3>Épreuves d'une Sainte Vivante</h3>
                <div class="sainthood-controls">
                    <div class="info-box">
                        <strong>Sainte Potentia Actuelle:</strong>
                        <span id="saint-potentia-name">Aucune</span>
                        <button id="select-saint-btn" class="btn-secondary">Choisir</button>
                        <button id="change-saint-btn" class="btn-danger">Changer (1 RP)</button>
                    </div>
                    <div class="info-box">
                        <label for="active-trial-select"><strong>Épreuve Active:</strong></label>
                        <select id="active-trial-select"></select>
                    </div>
                    <div class="info-box">
                        <strong>Points de Martyre:</strong>
                        <span id="martyrdom-points" class="stat-value">0</span>
                        <button class="tally-btn" data-action="decrease-martyrdom">-</button>
                        <button class="tally-btn" data-action="increase-martyrdom">+</button>
                    </div>
                </div>
                <div id="trials-grid">
                    </div>
                 <div class="info-panel" style="margin-top: 15px; background-color: #1a1a1a; padding: 15px;">
                    <h4>Récompenses de Sainte</h4>
                    <div id="saint-rewards-display">
                        <p>Les récompenses des Épreuves terminées (10+ points) apparaîtront ici.</p>
                    </div>
                </div>
            </div>
            
            <div id="deathguard-box" class="info-box hidden" style="grid-column: 1 / -1; background-color: #1a1a1a; padding: 15px; border: 1px solid var(--border-color); margin-top: 20px;">
                <h3 style="text-align: center; color: var(--friendly-color);">Centre de Commandement de la Peste</h3>
                <div class="sainthood-controls">
                    <div class="info-box">
                        <strong>Points de Contagion:</strong>
                        <span id="contagion-points" class="stat-value"></span>
                        <button class="tally-btn" data-action="decrease-contagion">-</button>
                        <button class="tally-btn" data-action="increase-contagion">+</button>
                    </div>
                    <div class="info-box">
                        <strong>Puissance du Pathogène:</strong>
                        <span id="pathogen-power" class="stat-value">1</span> / 5
                    </div>
                    <div class="info-box">
                        <strong>Taux de Reproduction:</strong> <span id="plague-reproduction" class="stat-value">1</span> / 6
                    </div>
                    <div class="info-box">
                        <strong>Taux de Survie:</strong> <span id="plague-survival" class="stat-value">1</span> / 6
                    </div>
                    <div class="info-box">
                        <strong>Adaptabilité:</strong> <span id="plague-adaptability" class="stat-value">1</span> / 6
                    </div>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <button id="upgrade-plague-btn" class="btn-secondary">Améliorer la Peste (5-10 PC)</button>
                </div>
            </div>

            <hr>

            <h3>Ordre de Bataille</h3>
            <table id="order-of-battle">
                <thead>
                    <tr>
                        <th>Nom de l'Unité</th>
                        <th>Rôle</th>
                        <th>Coût en Points</th>
                        <th>Points de Croisade</th>
                        <th>XP</th>
                        <th>Rang</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="units-tbody">
                </tbody>
            </table>
            <button id="add-unit-btn" class="btn-primary">Ajouter une Unité</button>

            <hr>

            <h3>Objectifs & Notes</h3>
            <textarea id="goals-notes" rows="4" placeholder="Notez ici les objectifs de croisade, les agendas ou d'autres notes..."></textarea>
        </section>
    </div>

    <div id="player-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3 id="player-modal-title">Ajouter un Joueur</h3>
            <form id="player-form">
                <input type="hidden" id="player-id">
                <label for="player-name-input">Nom du Joueur :</label>
                <input type="text" id="player-name-input" required>
                <label for="player-faction-input">Faction Principale :</label>
                <select id="player-faction-input" required>
                    <option value="" disabled selected>Choisir une faction...</option>
                    <optgroup label="Imperium">
                        <option value="Adepta Sororitas">Adepta Sororitas</option>
                        <option value="Adeptus Custodes">Adeptus Custodes</option>
                        <option value="Adeptus Mechanicus">Adeptus Mechanicus</option>
                        <option value="Adeptus Titanicus">Adeptus Titanicus</option>
                        <option value="Agents of the Imperium">Agents of the Imperium</option>
                        <option value="Astra Militarum">Astra Militarum</option>
                        <option value="Black Templars">Black Templars</option>
                        <option value="Blood Angels">Blood Angels</option>
                        <option value="Dark Angels">Dark Angels</option>
                        <option value="Deathwatch">Deathwatch</option>
                        <option value="Grey Knights">Grey Knights</option>
                        <option value="Imperial Knights">Imperial Knights</option>
                        <option value="Space Marines">Space Marines</option>
                        <option value="Space Wolves">Space Wolves</option>
                    </optgroup>
                    <optgroup label="Chaos">
                        <option value="Chaos Daemons">Chaos Daemons</option>
                        <option value="Chaos Knights">Chaos Knights</option>
                        <option value="Chaos Space Marines">Chaos Space Marines</option>
                        <option value="Death Guard">Death Guard</option>
                        <option value="Emperor's Children">Emperor's Children</option>
                        <option value="Thousand Sons">Thousand Sons</option>
                        <option value="World Eaters">World Eaters</option>
                    </optgroup>
                    <optgroup label="Xenos">
                        <option value="Aeldari">Aeldari</option>
                        <option value: "Drukhari">Drukhari</option>
                        <option value="Genestealer Cults">Genestealer Cults</option>
                        <option value="Leagues of Votann">Leagues of Votann</option>
                        <option value="Necrons">Necrons</option>
                        <option value="Orks">Orks</option>
                        <option value="T'au Empire">T'au Empire</option>
                        <option value="Tyranids">Tyranids</option>
                    </optgroup>
                </select>
                <button type="submit" class="btn-primary">Sauvegarder</button>
            </form>
        </div>
    </div>

    <div id="unit-modal" class="modal hidden">
        <div class="modal-content large crusade-card">
            <span class="close-btn">&times;</span>
            <h3 id="unit-modal-title" class="crusade-card-title">Fiche d'Unité de Croisade</h3>
            <form id="unit-form">
                <input type="hidden" id="unit-id">
                <div class="unit-card-header">
                     <div class="form-group">
                        <label for="unit-name">Nom de l'unité :</label>
                        <select id="unit-name" required>
                            <option value="" disabled selected>Choisir une unité...</option>
                        </select>
                    </div>
                </div>

                <div id="unit-upgrades-section">
                    <h4 class="upgrades-title">Gestion des Améliorations</h4>
                    <div class="upgrades-grid">

                        <div class="upgrade-control-group">
                            <label for="battle-trait-select">Trait de Bataille (+1 PC)</label>
                            <div class="input-group">
                                <select id="battle-trait-select"><option>Choisir un trait...</option></select>
                                <button type="button" class="btn-secondary" id="add-battle-trait-btn">Ajouter</button>
                            </div>
                        </div>
                        
                        <div class="upgrade-control-group">
                            <label for="weapon-mod-select">Modification d'Arme (+1 PC)</label>
                            <div class="input-group">
                                <select id="weapon-mod-select"><option>Choisir une modification...</option></select>
                                <button type="button" class="btn-secondary" id="add-weapon-mod-btn">Ajouter</button>
                            </div>
                        </div>

                        <div class="upgrade-control-group">
                            <label for="relic-select">Relique de Croisade</label>
                            <div class="input-group">
                                <select id="relic-select"><option>Choisir une relique...</option></select>
                                <button type="button" class="btn-secondary" id="add-relic-btn">Ajouter</button>
                            </div>
                        </div>

                        <div class="upgrade-control-group">
                            <label for="battle-scar-select">Cicatrice de Bataille</label>
                            <div class="input-group">
                                <select id="battle-scar-select"><option>Choisir une cicatrice...</option></select>
                                <button type="button" class="btn-secondary" id="add-battle-scar-btn">Ajouter</button>
                            </div>
                        </div>

                        <div class="upgrade-control-group">
                            <label for="sombreroche-honour-select">Honneur de Sombreroche (Éclats)</label>
                            <div class="input-group">
                                <select id="sombreroche-honour-select"><option>Choisir un honneur...</option></select>
                                <button type="button" class="btn-secondary" id="add-sombreroche-honour-btn">Acheter</button>
                            </div>
                        </div>

                        <div class="upgrade-control-group">
                            <label for="sombreroche-relic-select">Relique de Sombreroche (Éclats)</label>
                            <div class="input-group">
                                <select id="sombreroche-relic-select"><option>Choisir une relique...</option></select>
                                <button type="button" class="btn-secondary" id="add-sombreroche-relic-btn">Acheter</button>
                            </div>
                        </div>

                        <div id="biomorphology-section" class="upgrade-control-group hidden">
                            <label for="biomorphology-select">Biomorphologie (Biomasse)</label>
                            <div class="input-group">
                                <select id="biomorphology-select"><option>Choisir une adaptation...</option></select>
                                <button type="button" class="btn-secondary" id="add-biomorphology-btn">Absorber</button>
                            </div>
                        </div>
                        
                        <div id="nurgle-boon-section" class="upgrade-control-group hidden">
                            <label for="nurgle-boon-select">Bienfait de Nurgle (+1 PC)</label>
                            <div class="input-group">
                                <select id="nurgle-boon-select"><option>Choisir un bienfait...</option></select>
                                <button type="button" class="btn-secondary" id="add-nurgle-boon-btn">Accorder</button>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="unit-card-body">
                    <div class="unit-card-column">
                        <div class="form-group small">
                            <label for="unit-role">Rôle :</label>
                            <select id="unit-role">
                                <option value="Personnage">Personnage</option>
                                <option value="Hero Epique">Hero Epique</option>
                                <option value="Infantrie">Infanterie</option>
                                <option value="Cavalerie">Cavalerie</option>
                                <option value="Monstre">Monstre</option>
                                <option value="Vehicule">Véhicule</option>
                                <option value="Bête">Bête</option>
                                <option value="Fortification">Fortification</option>
                                <option value="Titanesque">Titanesque</option>
                                <option value="Nuée">Nuée</option>
                            </select>
                        </div>
                        <div class="form-group small"><label for="unit-power">Coût en Points :</label><input type="number" id="unit-power" min="0" required></div>
                        <div class="form-group small"><label for="unit-xp">XP :</label><input type="number" id="unit-xp" min="0"></div>
                        <div class="form-group small"><label for="unit-crusade-points">Points de Croisade :</label><input type="number" id="unit-crusade-points" min="0"></div>
                        <div class="form-group small"><strong>Rang:</strong> <span id="unit-rank-display"></span></div>
                        <div class="form-group"><label for="unit-equipment">Équipement :</label><textarea id="unit-equipment" rows="5"></textarea></div>
                        <div class="form-group"><label for="unit-warlord-trait">Trait de Seigneur de Guerre :</label><textarea id="unit-warlord-trait" rows="3"></textarea></div>
                        <div class="form-group"><label for="unit-relic">Relique :</label><textarea id="unit-relic" rows="3"></textarea></div>
                    </div>
                    <div class="unit-card-column">
                        <div class="form-group"><label for="unit-honours">Honneurs de Bataille :</label><textarea id="unit-honours" rows="5"></textarea></div>
                        <div class="form-group"><label for="unit-scars">Cicatrices de Bataille :</label><textarea id="unit-scars" rows="5"></textarea></div>
                        <div class="form-group"><label for="unit-marked-for-glory">Marqué pour la Gloire (unités détruites) :</label><input type="number" id="unit-marked-for-glory" min="0"></div>
                    </div>
                </div>

                <button type="submit" class="btn-primary">Sauvegarder l'Unité</button>
            </form>
        </div>
    </div>

    <div id="world-modal" class="modal hidden">
        <div class="modal-content x-large">
            <span class="close-btn">&times;</span>
            <h3 id="world-modal-title" class="crusade-card-title">Système Planétaire</h3>
            <button id="show-map-btn" class="btn-secondary" style="margin-bottom: 15px;">Voir la Carte Galactique</button>
            <button id="edit-crusade-order-btn" class="btn-primary" style="margin-bottom: 15px;">Éditer l'Ordre de Croisade</button>
            <div id="system-container">
                <button class="explore-arrow" id="explore-up" title="Explorer vers le Nord">↑</button>
                <button class="explore-arrow" id="explore-left" title="Explorer vers l'Ouest">←</button>
                <div id="planetary-system">
                </div>
                <button class="explore-arrow" id="explore-right" title="Explorer vers l'Est">→</button>
                <button class="explore-arrow" id="explore-down" title="Explorer vers le Sud">↓</button>
            </div>
            <div id="planet-legend">
                <h4>Légende des Planètes <span id="colonization-percentage"></span></h4>
                <div class="legend-item"><span class="legend-color" data-type="Monde Mort"></span> Monde Mort</div>
                <div class="legend-item"><span class="legend-color" data-type="Monde Sauvage"></span> Monde Sauvage</div>
                <div class="legend-item"><span class="legend-color" data-type="Agri-monde"></span> Agri-monde</div>
                <div class="legend-item"><span class="legend-color" data-type="Monde Forge"></span> Monde Forge</div>
                <div class="legend-item"><span class="legend-color" data-type="Monde Ruche"></span> Monde Ruche</div>
                <div class="legend-item"><span class="legend-color" data-type="Monde Saint (relique)"></span> Monde Saint (relique)</div>
            </div>
        </div>
    </div>

    <div id="planet-type-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3 id="planet-type-modal-title">Définir le type de la planète</h3>
            <form id="planet-type-form">
                <input type="hidden" id="planet-system-id">
                <input type="hidden" id="planet-index">
                <div class="form-group">
                    <label for="planet-name-input">Nom de la planète:</label>
                    <input type="text" id="planet-name-input">
                </div>
                <div class="form-group">
                    <label for="planet-type-select">Type de Monde :</label>
                    <select id="planet-type-select">
                        <option value="Monde Mort">Monde Mort</option>
                        <option value="Monde Sauvage">Monde Sauvage</option>
                        <option value="Agri-monde">Agri-monde</option>
                        <option value="Monde Forge">Monde Forge</option>
                        <option value="Monde Ruche">Monde Ruche</option>
                        <option value="Monde Saint (relique)">Monde Saint (relique)</option>
                    </select>
                </div>
                 <div class="form-group">
                    <label for="planet-owner-select">Propriétaire :</label>
                    <select id="planet-owner-select">
                        </select>
                </div>
                <div class="form-group" id="planet-defense-container">
                    <label for="planet-defense-input">Points de Défense (PNJ):</label>
                    <input type="number" id="planet-defense-input" min="0" step="50">
                </div>
                <button type="submit" class="btn-primary">Valider</button>
                <button type="button" id="randomize-planet-btn" class="btn-secondary">Randomiser Planète (2 RP)</button>
                <button type="button" id="halve-defense-btn" class="btn-secondary hidden">Saboter Défenses (1 RP)</button>
            </form>
        </div>
    </div>

    <div id="map-modal" class="modal hidden">
        <div class="modal-content large">
            <span class="close-btn">&times;</span>
            <h3 class="crusade-card-title">Carte Galactique</h3>
            <div class="map-controls">
                <label for="map-player-view-select">Point de vue :</label>
                <select id="map-player-view-select"></select>
            </div>
            <div id="galactic-map-container">
            </div>
        </div>
    </div>

    <div id="info-modal" class="modal hidden">
        <div class="modal-content info-panel">
            <span class="close-btn">&times;</span>
            <h3 class="info-title">Briefing de la Croisade Nexus</h3>
            <div class="info-body">
                <h4>Déploiement Initial et Zone de Rassemblement</h4>
                <p>Votre glorieuse croisade débute dans un secteur isolé de la galaxie, à l'abri des tempêtes Warp et des yeux indiscrets de vos rivaux. Ce système natal est votre sanctuaire et votre terrain d'entraînement. Il est entièrement immunisé et ne peut être découvert par d'autres commandants.</p>
                <p>Prouvez votre valeur et votre maîtrise stratégique en unifiant ce secteur. Pour rejoindre le théâtre principal de la guerre galactique, une condition doit être remplie :</p>
                <ul>
                    <li><b>Unification du Système Natal :</b> Vous devez purger et prendre le contrôle de <b>toutes</b> les planètes de votre système de départ.</li>
                </ul>
                <p>Ce n'est qu'après avoir établi votre suprématie que la lumière de l'Astronomican vous guidera, perçant un chemin à travers l'Immaterium pour connecter votre bastion à la carte principale. Tant que votre secteur n'est pas unifié, vous ne pouvez être ni attaqué, ni découvrir les secrets que la galaxie recèle.</p>

                <h4>Naviguer dans le Vide</h4>
                <p>Une fois votre tête de pont établie, deux méthodes s'offrent à vous pour étendre votre influence à travers les étoiles :</p>
                <ul>
                    <li><b>Le Saut à l'Aveugle :</b> Une transition périlleuse et non guidée dans l'inconnu. Rapide, gratuite, mais chargée de dangers. Un tel saut peut vous mener vers des mondes non réclamés ou directement dans les griffes d'une flotte ennemie. Soyez prévenu : une telle arrivée est tout sauf discrète. Votre présence sera immédiatement connue de tous dans le système de destination au moment où vous émergerez du Warp.</li>
                    <li><b>La Sonde Augure (1 PR) :</b> Un risque calculé. Pour un Point de Réquisition, lancez une sonde dans le vide. Elle rapportera ses découvertes : un système PNJ dormant, mûr pour la conquête, ou la silhouette menaçante d'une croisade rivale. Une route sondée nécessite un second ordre de votre part pour établir un passage Warp permanent.</li>
                </ul>

                <h4>Règles d'Engagement</h4>
                <ul>
                    <li><b>Contact Hostile :</b> Lorsque votre chemin croise celui d'un commandant rival, la décision d'établir une route stable vous appartient. Mais un tel acte est irréversible et à double sens. Ouvrir un chemin vers votre ennemi révèle instantanément la position de votre propre système. Les tambours de la guerre sonneront pour les deux camps.</li>
                    <li><b>Blocus de Système :</b> Vous ne pouvez pas lancer de flottes d'exploration <b>depuis</b> un système où une présence ennemie est établie. Leur flotte agit comme un blocus, une dague pointée sur votre gorge. Vous devez purger le xenos, l'hérétique ou le rival avant de pouvoir à nouveau tourner votre regard vers les étoiles.</li>
                    <li><b>Établir une Tête de Pont :</b> Pour poursuivre votre avancée, vous devez contrôler au moins un monde dans un système pour l'utiliser comme base de départ pour de futures explorations.</li>
                </ul>
                
                <h4>La Fureur du Maelström (Explosion du Warp)</h4>
                <p>Le protocole "Explosion du Warp" est une mesure de dernier recours, un événement cataclysmique qui redessine la galaxie. L'activer projettera tous les systèmes connus dans l'oubli, rompant toutes les connexions. Votre force de croisade – vos unités, votre expérience, vos ressources – perdurera, mais vous serez rejeté dans un nouveau système natal isolé, forcé de recommencer la conquête au milieu d'une mer d'étoiles fraîchement née.</p>
            </div>
        </div>
    </div>
    
    <div id="notification-container"></div>

    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3 id="confirm-modal-title">Confirmation</h3>
            <p id="confirm-modal-text" style="line-height: 1.6;"></p>
            <div class="modal-actions">
                <button id="confirm-modal-cancel-btn" class="btn-secondary">Annuler</button>
                <button id="confirm-modal-ok-btn" class="btn-primary">Confirmer</button>
            </div>
        </div>
    </div>
    
    <div id="exploration-choice-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3 id="exploration-choice-title">Méthode d'Exploration</h3>
            <p id="exploration-choice-text" style="line-height: 1.6;"></p>
            <div class="modal-actions" style="justify-content: space-between; flex-wrap: wrap;">
                <button id="exploration-choice-cancel-btn" class="btn-secondary">Annuler</button>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="exploration-choice-blind-jump-btn" class="btn-primary">Saut à l'aveugle</button>
                    <button id="exploration-choice-probe-btn" class="btn-primary">Envoyer la sonde (1 RP)</button>
                </div>
            </div>
        </div>
    </div>

    <div id="plague-management-modal" class="modal hidden">
        <div class="modal-content large">
            <span class="close-btn">&times;</span>
            <h3 id="plague-modal-title" class="crusade-card-title">Guerre Bactériologique</h3>
            <div id="plague-warfare-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4 style="text-align: center;">Caractéristiques du Monde</h4>
                    <div class="info-box"><strong>Fécondité:</strong> <span id="planet-fecundity"></span></div>
                    <div class="info-box"><strong>Densité de Population:</strong> <span id="planet-population"></span></div>
                    <div class="info-box"><strong>Vulnérabilité:</strong> <span id="planet-vulnerability"></span></div>
                </div>
                <div>
                    <h4 style="text-align: center;">Caractéristiques de la Peste</h4>
                    <div class="info-box"><strong>Taux de Reproduction:</strong> <span id="player-plague-reproduction"></span></div>
                    <div class="info-box"><strong>Taux de Survie:</strong> <span id="player-plague-survival"></span></div>
                    <div class="info-box"><strong>Adaptabilité:</strong> <span id="player-plague-adaptability"></span></div>
                </div>
            </div>
            <hr>
            <div style="text-align: center;">
                <h3>Total de Peste: <span id="total-peste-value" style="color: var(--friendly-color);">0</span></h3>
                <p>Le Total de Peste est la somme des 3 scores combinés ci-dessus.</p>
                <p>Un score de <b>7+</b> est nécessaire pour tenter de Concrétiser la Peste.</p>
                <button id="conquer-plague-btn" class="btn-primary" disabled>Concrétiser la Peste (1 PR)</button>
            </div>
        </div>
    </div>

    <script src="engine.js"></script> 
    <script src="rules.js"></script>
    <script src="galaxy.js"></script>
    <script src="sororitas_rules.js"></script> 
    <script src="render.js"></script>
    <script src="upgrades.js"></script>
    <script src="main.js"></script>
</body>
</html>